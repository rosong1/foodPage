(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{E3p6:function(e,t,a){"use strict";a.r(t);var r=a("d6i3"),s=a.n(r),n=a("0YDr"),i=a.n(n),o=a("J2m7"),l=a.n(o),u=a("UfWW"),d=a.n(u),c=a("E+oP"),b=a.n(c),p=a("jxKE"),v=a("0lfv"),m=a("g0q0"),g={tableNo:"",isPack:!1,taste:"",remark:"",list:[],id:"",totalMoney:0},O=e=>{if(b()(e))return[];var t=[],a=e=>{var t=e.isPack,a=e.tableNo,r=e.orderTime,s=e=>`${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}`;return a||(t?`\u6253\u5305(${s(new Date(Number(r)))})`:`\u65b0\u684c(${s(new Date(Number(r)))})`)},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,r=e.foods,s=r?Object.assign({},r):{},n=(e,t,r)=>{if(t){var s=Object.assign({},t);return s.count.push({value:r.count,status:r.status,orderTime:e.orderTime,id:a}),s}return Object.assign({},r,{count:[{value:r.count,status:r.status,orderTime:e.orderTime,id:a}],taste:e.taste})};return t.forEach(t=>{s[t.value]=n(e,s[t.value],t)}),s};return e.forEach(e=>{var s=a(Object.assign({},e,{orderTime:e.orderTime})),n=d()(t,e=>e.label===s),i=t[n];if(i){i.ids.push(e.id);var o=(e,t)=>{return e?t?`${e},${t}`:e:t},l=Object.assign({},i,{remark:o(i.remark,e.remark),totalMoney:i.totalMoney+e.totalMoney,foods:r(i,e.orderList,e.id)});t.splice(n,1,l)}else{var u=r(e,e.orderList,e.id);t.push(Object.assign({},e,{foods:u,label:s,ids:[e.id],editing:p["f"].disable,tempOrderList:[]}))}}),t},f=e=>{var t=(e,t)=>{var a=e.map(e=>e.tableNo);return t.filter(e=>!a.includes(e.value))},a=Object(v["b"])(),r=O(a),s=t(a,e);return[...r,...s]};t["default"]={namespace:"tableno",state:{tableList:[],seletedIdx:0,editModal:!1},reducers:{initTableList(e,t){var a=t.payload.tableList;return Object.assign({},e,{tableList:a})},setSelectIdx(e,t){var a=t.payload.seletedIdx;return Object.assign({},e,{seletedIdx:a})},setModelData(e,t){var a=t.payload;return Object.assign({},e,a)},reset(e){return Object.assign({},e,{order:g})},increFood(e,t){var a=t.payload,r=a.food,s=a.tableLabel,n=l()(e.tableList,e=>e.label===s),i=e=>d()(e,e=>e.value===r.value),o=(e,t)=>{var a=i(e),r=e[a];-1===a?e.push(Object.assign({},t,{count:1,status:p["c"].normal})):e[a]=Object.assign({},r,{count:r.count+1,status:p["c"].normal})};return o(n.tempOrderList,r),Object.assign({},e,{tableList:e.tableList.map(e=>e.id===n.id?n:e)})},decreFood(e,t){var a=t.payload,r=a.food,s=a.tableLabel,n=l()(e.tableList,e=>e.label===s),o=(e,t)=>e.foods[t.value],u=e=>e.count.map(e=>e.value),c=e=>i()(u(o(n,e))),b=(e,t)=>{return e<=0&&Math.abs(e)>t?-t:e},v=e=>d()(e,e=>e.value===r.value),m=(e,t)=>{var a=v(e),r=e[a];-1===a?e.push(Object.assign({},t,{count:b(-1,c(t)),status:p["c"].normal})):e[a]=Object.assign({},r,{status:p["c"].normal,count:b(r.count-1,c(t))})};return m(n.tempOrderList,r),Object.assign({},e,{tableList:e.tableList.map(e=>e.id===n.id?n:e)})},updateTableList(e,t){var a=t.payload,r=a.tableData,s=void 0===r?{}:r;a.debug;return Object.assign({},e,{tableList:e.tableList.map(e=>e.id===s.id?s:e)})},removeTableData(e,t){var a=t.payload.tableData,r=void 0===a?{}:a;return Object.assign({},e,{tableList:e.tableList.filter(e=>e.id!==r.id)})}},effects:{fetchTableList:s.a.mark(function e(t,a){var r,n,i,o,l;return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.call,n=a.put,i=(e=>new Promise(t=>setTimeout(t,e))),e.next=4,r(i,100);case 4:return o=Object(m["a"])(),l=f(o),e.next=8,n({type:"initTableList",payload:{tableList:l}});case 8:case"end":return e.stop()}},e)}),payMoney:s.a.mark(function e(t,a){var r,n,i,o,l,u,d,c,b,m;return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload,n=r.tableData,i=void 0===n?{}:n,o=r.realMoney,l=a.call,u=a.put,d=i.status==p["g"].paid?p["g"].normal:p["g"].paid,d==p["g"].paid,console.error("realMoney",o),c=(()=>{var e=Object(v["b"])(),t=e=>{var t=i.ids,a=i.id;return e.id===a?Object.assign({},e,{status:d,realMoney:o}):t.includes(e.id)?Object.assign({},e,{status:d}):e},a=e.map(t);Object(v["e"])(p["e"].bookingOrder,a)}),b=(e=>new Promise(t=>setTimeout(t,e))),c(),e.next=10,l(b,100);case 10:return m=Object.assign({},i,{status:d,realMoney:o}),e.next=13,u({type:"updateTableList",payload:{tableData:m}});case 13:case"end":return e.stop()}},e)}),leave:s.a.mark(function e(t,a){var r,n,i,o,l,u;return s.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.payload.tableData,n=void 0===r?{}:r,i=a.call,o=a.put,l=(()=>{var e=n.ids,t=Object(v["b"])(),a=t.filter(t=>!e.includes(t.id));Object(v["e"])(p["e"].bookingOrder,a)}),u=(e=>new Promise(t=>setTimeout(t,e))),l(),e.next=7,i(u,100);case 7:return e.next=9,o({type:"removeTableData",payload:{tableData:n}});case 9:case"end":return e.stop()}},e)})}}}}]);